<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mapFinder</title>
    <link rel="icon" type="image/x-icon" href="/frontend/images/favicon.ico">
</head>
<body>
    <h1>–í–≤–µ–¥—ñ—Ç—å –∞–¥—Ä–µ—Å—É: </h1>

    <input id="query" placeholder="–ü–æ—à—É–∫...">
    <button id="search">üîç –ó–Ω–∞–π—Ç–∏</button>

    <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç: </h1>

    <div>
    <input id="address" placeholder="–ê–¥—Ä–µ—Å–∞" readonly>
    <input id="link" placeholder="–ü–æ—Å–∏–ª–∞–Ω–Ω—è" readonly>
    <input id="coordinates" placeholder="–ö–æ—Ä–¥–∏–Ω–∞—Ç–∏" readonly>
    </div>

    <script>
        document.getElementById("search").addEventListener("click", function () {
            const query = document.getElementById("query").value;
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É—î–º–æ –≤–≤–µ–¥–µ–Ω—É –∞–¥—Ä–µ—Å—É –≤ —Ñ–æ—Ä–º–∞—Ç JSON
            const data = JSON.stringify(query);

            // –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π XMLHttpRequest
            const xhr = new XMLHttpRequest();
            xhr.withCredentials = true;

            // –°–ª—É—Ö–∞—î–º–æ –∑–º—ñ–Ω—É —Å—Ç–∞–Ω—É –∑–∞–ø–∏—Ç—É
            xhr.addEventListener("readystatechange", function () {
                if (this.readyState === this.DONE) {
                    if (this.status === 200) {
                        try {
                            const responseData = JSON.parse(this.responseText);

                            // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
                            document.getElementById("address").value = responseData.address || "–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö";
                            document.getElementById("link").value = responseData.link || "–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö";
                            document.getElementById("coordinates").value = responseData.coordinates || "–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö";
                        } catch (error) {
                            console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥—É JSON:", error);
                        }
                    } else {
                        console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø–∏—Ç—É:", this.status, this.statusText);
                    }
                }
            });

            // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ POST-–∑–∞–ø–∏—Ç
            xhr.open("POST", "https://mapfinder-production.up.railway.app/addr");
            xhr.setRequestHeader("Content-Type", "application/json");

            xhr.send(data);
        });
    </script>
</body>
</html>
